las=2,
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2)))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2)))
text(x=47, # ajout de texte sur le graph
y=5, # modifie la position du texte
labels = c("Taille moyenne 1996:\n\n",round(mean(taille_96),2)))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2)))
text(x=47, # ajout de texte sur le graph
y=7, # modifie la position du texte
labels = c("Taille moyenne 1996:\n\n",round(mean(taille_96),2)))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2),"m"))
text(x=47, # ajout de texte sur le graph
y=7, # modifie la position du texte
labels = c("Taille moyenne 1996:\n\n",round(mean(taille_96),2),"m"))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2),"\n\nm"))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2),"\n m"))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2),"  m"))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2),"     m"))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2),"\tm"))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2),"\t\tm"))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
sub = c("Taille moyenne 1914 :",mean(taille_14),"Taille moyenne 1996 :",mean(taille_96)),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2)))
text(x=47, # ajout de texte sur le graph
y=7, # modifie la position du texte
labels = c("Taille moyenne 1996:\n\n",round(mean(taille_96),2)))
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2)))
text(x=47, # ajout de texte sur le graph
y=7, # modifie la position du texte
labels = c("Taille moyenne 1996:\n\n",round(mean(taille_96),2)))
shapiro.test(taille_14)
shapiro.test(taille_96)
taille_14 = rep(c(1.47, 1.55, 1.57, 1.6, 1.63, 1.65, 1.68, 1.7, 1.73, 1.75, 1.78, 1.8, 1.83, 1.85, 1.88, 1.91, 1.93, 1.96),c(1, 1, 4, 6, 8, 16, 17, 14, 18, 11, 8, 12, 2, 3, 1, 0, 0, 0))
taille_96 = rep(c(1.47, 1.55, 1.57, 1.6, 1.63, 1.65, 1.68, 1.7, 1.73, 1.75, 1.78, 1.8, 1.83, 1.85, 1.88, 1.91, 1.93, 1.96),c(0, 0, 0, 0, 2, 5, 2, 7, 8, 10, 12, 8, 11, 6, 2, 3, 1, 3))
an <- matrix(
data = c(1, 1, 4, 6, 8, 16, 17, 14, 18, 11, 8, 12, 2, 3, 1, 0, 0, 0, 0, 0, 0, 0, 2, 5, 2, 7, 8, 10, 12, 8, 11, 6, 2, 3, 1, 3),
nrow=2, byrow = TRUE
)
rownames(an)<-c("an_14","an_96")
colnames(an)<-c(1.47, 1.55, 1.57, 1.6, 1.63, 1.65, 1.68, 1.7, 1.73, 1.75, 1.78, 1.8, 1.83, 1.85, 1.88, 1.91, 1.93, 1.96)
graph <- barplot(an,
legend.text = c("1914", "1996"),
beside = T,
main="Fréquence d'observation des tailles selon l'année",
las=2,
xlab = "taille (m)",
ylim = c(0, 20),
ylab = "proportion",
col=c("lightblue","deepskyblue"),
)
text(x=47, # ajout de texte sur le graph
y=10, # modifie la position du texte
labels = c("Taille moyenne 1914:\n\n",round(mean(taille_14),2)))
text(x=47, # ajout de texte sur le graph
y=7, # modifie la position du texte
labels = c("Taille moyenne 1996:\n\n",round(mean(taille_96),2)))
shapiro.test(taille_14)
shapiro.test(taille_96)
var.test(an_14,an_96)
var.test(taille_14,taille_96)
var.test(taille_14,taille_96)
t.test(taille_14,taille_96,var.equal = T)
t.test(taille_96,taille_14,var.equal = T, alternative = "greater")
t.test(taille_96,taille_14,var.equal = T, alternative = "greater")
t.test(taille_96,taille_14,var.equal = T, alternative = "less")
# test1 : les hommes deviennent de plus en plus grands
t.test(taille_96,taille_14,var.equal = T, alternative = "greater")
# test2 : les hommes étaient plus grands avant
t.test(taille_96,taille_14,var.equal = T, alternative = "less")
knitr::opts_chunk$set(echo = TRUE)
library(limma)
install.packages(limma)
install.packages("C:/Users/camil/Downloads/limma_2.10.7.tar.gz", repos = NULL, type = "source")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("limma")
library(limma)
YL <- as.numeric(info$stage=='YL')
BiocManager::install("made4")
library(made4) # permet de faire de l'analyse multivariée
setwd("~/GitHub/fr.univ-tlse3_ADM_project/scripts")
>>>>>>> 437696c06da52affc33a9fb9e47a9560c2662409
chisq.test(commu, habitat)
summary(chisq.test(commu, habitat))
habitat = read.table("../data/habitat.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
especes = read.table("../data/especes.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
commu = read.table("../data/communautes.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
habitat = read.table("../data/habitat.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
especes = read.table("../data/especes.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
commu = read.table("../data/communautes.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
View(commu)
View(commu)
View(especes)
View(especes)
View(habitat)
View(habitat)
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
taille = length(commu[1,])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
chisq.test(commu[,i], habitat[j,])
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
taille = length(commu[1,])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
chisq.test(commu[,index_espece], habitat[index_localisation,])
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
taille = length(commu[1,])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
chisq.test(commu[,index_espece], t(habitat[index_localisation,]))
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
taille = length(commu[1,])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
chisq.test(commu[,index_espece], t(as.matrix(habitat[index_localisation,])))
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
taille = length(commu[1,])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
chisq.test(commu[,index_espece], t(as.matrix(habitat[index_localisation, 4:19])))
}
}
habitat_matrice = habitat[,4:19]
View(habitat_matrice)
habitat_matrice = as.matrix(habitat[,4:19])
View(habitat_matrice)
habitat_matrice = t(as.matrix(habitat[,4:19]))
habitat = habitat[,1-4:19]
View(habitat)
View(habitat)
habitat = habitat[,-2:3]
View(habitat)
habitat = read.table("../data/habitat.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
habitat = habitat[,-2:3]
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
chisq.test(commu, habitat)
taille = commu[,1]
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
chisq.test(commu[,index_espece], habitat[index_localisation,])
}
}
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
chisq.test(commu[,index_espece], habitat[,index_localisation])
}
}
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
print(chisq.test(commu[,index_espece], habitat[,index_localisation]))
}
}
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
print(chisq.test(commu[,index_espece], habitat[,index_localisation]))
}
}
taille = length(commu[,1])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
print(chisq.test(commu[,index_espece], habitat[,index_localisation]))
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
write.table(x = data_chi2_q1, file = "chi-2_q1_export.txt", fileEncoding = "UTF-8")
}
}
write.table(x = data_chi2_q1,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8",
sep = " ",
eol = "\n")
write.csv(x = data_chi2_q1,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8",
sep = " ",
eol = "\n")
write.csv(x = data_chi2_q1,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
write.csv(x = data_chi2_q1,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
View(data_chi2_q1)
View(data_chi2_q1)
write.csv(x = cat(commu[,index_espece], habitat[,index_localisation], pvalue, sep = ","),
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
file.create("chi-2_q1_export.txt")
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
pvalue = data_chi2_q1$p.value
write.csv(x = cat(commu[,index_espece], habitat[,index_localisation], pvalue, sep = ","),
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
file.create("chi-2_q1_export.txt")
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
pvalue = data_chi2_q1$p.value
write.csv(x = c(commu[,index_espece], habitat[,index_localisation], pvalue, sep = ","),
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
file.create("chi-2_q1_export.txt")
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
pvalue = data_chi2_q1$p.value
write.csv(x = commu[,index_espece], habitat[,index_localisation], pvalue,
sep = ",",
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
file.create("chi-2_q1_export.txt")
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
pvalue = data_chi2_q1$p.value
write.csv(x = commu[,index_espece], habitat[,index_localisation], pvalue,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
file.create("chi-2_q1_export.txt")
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
pvalue = data_chi2_q1$p.value
texte = paste(commu[,index_espece], habitat[,index_localisation], pvalue, sep = ",")
write.csv(x = texte,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
file.create("chi-2_q1_export.txt")
file.edit()
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
pvalue = data_chi2_q1$p.value
texte = paste(paste(commu[,index_espece], habitat[,index_localisation], sep = ","), pvalue, sep = ",")
write.csv(x = texte,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
habitat = read.table("../data/habitat.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
especes = read.table("../data/especes.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
commu = read.table("../data/communautes.tsv", sep = "\t",
stringsAsFactors = T, header = T, na.strings = T)
# présence de l'espèce : commu colonnes
# caractéristiques du milieu : habitat lignes
# chi-2 entre espèce et chaque caractéristique du milieu
habitat = habitat[,-2:-3]
chisq.test(commu, habitat)
taille = length(commu[,1])
file.create("chi-2_q1_export.txt")
file.edit()
for (index_espece in 1:taille){
for (index_localisation in 1:taille){
data_chi2_q1 = chisq.test(commu[,index_espece], habitat[,index_localisation])
pvalue = data_chi2_q1$p.value
texte = paste(paste(commu[,index_espece], habitat[,index_localisation], sep = ","), pvalue, sep = ",")
write.csv(x = texte,
file = "chi-2_q1_export.txt",
append = TRUE,
fileEncoding = "UTF-8")
}
}
